<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
  <title>–§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    /* –±–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —É–¥–æ–±–Ω—ã–µ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è */
    :root{
      --bg1:#111216;
      --bg2:#1a1c1f;
      --muted:rgba(255,255,255,.72);
      --glass:rgba(255,255,255,.02);
      --gap:12px;
      --radius:12px;
      --card-pad:20px;
      --btn-pad:10px 14px;
      --max-width:900px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:linear-gradient(160deg,var(--bg1),var(--bg2));
      color:#e6eef8;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.3;
      font-size:clamp(14px, 1.6vw, 16px);
    }

    /* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ñ–æ—Ä–º—ã */
    .wrap{
      width:min(92%, var(--max-width));
      background:linear-gradient(180deg,#0f1113,#17181a);
      border-radius:var(--radius);
      padding:var(--card-pad);
      box-shadow:0 12px 36px rgba(2,6,23,.6);
      border:1px solid rgba(255,255,255,.03);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }

    header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
    .logo{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;background:#0b0c0e;border:1px solid rgba(255,255,255,.03);font-weight:700;color:#9fb8ff;font-size:20px}
    h1{font-size:clamp(16px,2.2vw,20px);margin:0}
    p.desc{margin:4px 0 14px;color:var(--muted);font-size:13px}

    label.small{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}

    /* –ø–æ–ª—è –∏ –∫–Ω–æ–ø–∫–∏ */
    .field-row{display:flex;gap:10px;align-items:center}
    input[type=text], input[type=tel], textarea {
      padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,.04);
      background:linear-gradient(180deg,rgba(255,255,255,.01),rgba(255,255,255,.005));
      color:inherit;outline:none;font-size:14px;width:100%;
      transition: box-shadow .12s, transform .08s;
    }
    input[type=text]:focus, input[type=tel]:focus, textarea:focus {
      box-shadow:0 6px 18px rgba(0,0,0,.45);
      transform:translateY(-1px);
    }
    textarea{min-height:110px;resize:vertical}

    .phone-box{display:flex;gap:10px;align-items:center;width:100%;}
    .phone-code{font-family:monospace;background:linear-gradient(180deg,rgba(255,255,255,.01),rgba(255,255,255,.02));padding:10px 12px;border-radius:10px;text-align:center;font-size:15px;letter-spacing:1px;border:1px solid rgba(255,255,255,.03);min-width:0;flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

    button.btn{
      background:linear-gradient(180deg,rgba(0,0,0,.55),rgba(255,255,255,.01));
      border:1px solid rgba(255,255,255,.04);
      color:var(--muted);
      padding:var(--btn-pad);
      border-radius:10px;font-weight:600;cursor:pointer;
      display:inline-flex;align-items:center;gap:8px;
      user-select:none;
    }
    button.btn:hover{transform:translateY(-2px)}
    .small-ghost{
      background:transparent;border:1px solid rgba(255,255,255,.06);padding:8px 10px;border-radius:8px;color:var(--muted);cursor:pointer;
      min-width:44px;text-align:center;
    }

    .muted{font-size:13px;color:var(--muted)}

    .row{display:flex;gap:10px;align-items:center}

    .footer{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-top:14px;gap:10px}
    .footer .muted{flex:1;min-width:150px}
    .footer button{flex:0 0 auto}

    /* ip grid —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π - –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å—Å—è */
    .ip-grid{
      display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin-top:8px;
    }
    .ip-part{
      display:flex;flex-direction:column;align-items:center;gap:8px;padding:8px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,.005),rgba(255,255,255,.01));border:1px solid rgba(255,255,255,.02);min-width:66px;
      flex:1 1 22%;
      min-width:110px;
    }
    .ip-num{font-family:monospace;font-size:15px;padding:6px 10px;border-radius:6px;background:transparent;border:1px solid rgba(255,255,255,.02);min-width:44px;text-align:center}

    .ip-controls{display:flex;gap:6px;flex-wrap:wrap;justify-content:center}
    .nick{font-family:monospace;padding:8px 10px;border-radius:8px;background:rgba(255,255,255,.02);display:inline-block;min-width:90px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}

    /* –º–æ–¥–∞–ª–∫–∞ */
    .modal-backdrop{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(0deg, rgba(0,0,0,.55), rgba(0,0,0,.65));z-index:9999}
    .modal{
      background:linear-gradient(180deg,#0b1220,#071022);padding:18px;border-radius:12px;min-width:300px;border:1px solid rgba(255,255,255,.04);animation:pop .36s cubic-bezier(.2,.9,.3,1);
      width:min(92%,520px);
    }
    @keyframes pop{0%{transform:translateY(-20px) scale(.96);opacity:0}60%{transform:translateY(6px) scale(1.01);opacity:1}100%{transform:translateY(0) scale(1);opacity:1}}
    .hint{font-size:12px;color:rgba(230,238,248,.62);text-align:center}

    /* –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ —Ñ–æ–∫—É—Å */
    button:focus, input:focus, textarea:focus { outline: 3px solid rgba(159,184,255,.12); outline-offset:2px; }

    /* –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ */
    @media (max-width:560px){
      body{padding:14px;font-size:15px}
      .field-row{flex-direction:column;align-items:stretch}
      .phone-box{flex-direction:column;align-items:stretch}
      .phone-code{font-size:16px;padding:14px;border-radius:12px}
      .ip-part{flex:1 1 48%;min-width:48%}
      .wrap{padding:14px}
      .logo{width:40px;height:40px;font-size:18px}
      .ip-part{min-width:44%}
      .footer{align-items:stretch}
    }

    @media (min-width:900px){
      .wrap{padding:26px}
      .ip-part{min-width:170px;flex:1 1 22%}
    }

    /* —Å—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–æ–∫ +/- —á—Ç–æ–±—ã –±—ã–ª–∏ –∫—Ä—É–ø–Ω–µ–µ –Ω–∞ touch */
    .field-row .btn, .small-ghost { touch-action: manipulation; -webkit-tap-highlight-color: rgba(0,0,0,0); }
  </style>
</head>
<body>
  <div class="wrap" role="main">
    <header>
      <div class="logo" aria-hidden="true">üè≥Ô∏è‚Äçüåà</div>
      <div>
        <h1>–§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏</h1>
        <p class="desc">–û—Å—Ç–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –Ω–∞—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.</p>
      </div>
    </header>

    <form id="fbform" novalidate>
      <div>
        <label class="small">–¢–µ–ª–µ—Ñ–æ–Ω</label>
        <div class="phone-box">
          <div class="field-row" style="gap:8px;flex:0 0 auto">
            <button type="button" class="btn" id="dec" aria-label="—É–º–µ–Ω—å—à–∏—Ç—å">‚àí</button>
            <button type="button" class="btn" id="inc" aria-label="—É–≤–µ–ª–∏—á–∏—Ç—å">+</button>
          </div>
          <div id="phoneDisplay" class="phone-code" role="status" aria-live="polite">+1 000 000 0000</div>
        </div>
        <div class="hint" id="phoneHint">–ù–∞–∂–º–∏ + —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –Ω–æ–º–µ—Ä, - —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å</div>
      </div>

      <div style="margin-top:12px">
        <label class="small">–ò–º—è</label>
        <div class="field-row">
          <input type="text" id="nameField" readonly value="">
          <button type="button" class="small-ghost" id="rndName">—Ä–∞–Ω–¥–æ–º</button>
        </div>
      </div>

      <div style="margin-top:12px">
        <label class="small">–ù–∏–∫ –≤ —Ç–≥</label>
        <div class="row" style="width:100%;">
          <div id="tgNick" class="nick" aria-live="polite"></div>
          <div style="margin-left:auto;display:flex;gap:8px">
            <button type="button" class="small-ghost" id="rndNick">—Å–≥–µ–Ω–µ—Ä–∏—Ç—å</button>
            <button type="button" class="small-ghost" id="copyNick">–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          </div>
        </div>
        <div class="muted">–ù–∏–∫ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ: 5-10 –±—É–∫–≤</div>
      </div>

      <div style="margin-top:12px">
        <label class="small">IP (—Å–æ–±–µ—Ä–∏ –ø–∞–∑–ª–∞–º–∏)</label>
        <div class="ip-grid" id="ipGrid">
          <div class="ip-part" data-index="0">
            <div class="ip-controls"><button type="button" class="small-ghost move-left" id="moveLeft0" aria-label="–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤–ª–µ–≤–æ">‚Äπ</button><button type="button" class="small-ghost move-right" id="moveRight0" aria-label="–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤–ø—Ä–∞–≤–æ">‚Ä∫</button></div>
            <div id="ipPart0" class="ip-num">0</div>
            <div class="ip-controls"><button type="button" class="small-ghost" id="decIp0" aria-label="—É–º–µ–Ω—å—à–∏—Ç—å">‚àí</button><button type="button" class="small-ghost" id="incIp0" aria-label="—É–≤–µ–ª–∏—á–∏—Ç—å">+</button></div>
          </div>
          <div class="ip-part" data-index="1">
            <div class="ip-controls"><button type="button" class="small-ghost move-left" id="moveLeft1">‚Äπ</button><button type="button" class="small-ghost move-right" id="moveRight1">‚Ä∫</button></div>
            <div id="ipPart1" class="ip-num">0</div>
            <div class="ip-controls"><button type="button" class="small-ghost" id="decIp1">‚àí</button><button type="button" class="small-ghost" id="incIp1">+</button></div>
          </div>
          <div class="ip-part" data-index="2">
            <div class="ip-controls"><button type="button" class="small-ghost move-left" id="moveLeft2">‚Äπ</button><button type="button" class="small-ghost move-right" id="moveRight2">‚Ä∫</button></div>
            <div id="ipPart2" class="ip-num">0</div>
            <div class="ip-controls"><button type="button" class="small-ghost" id="decIp2">‚àí</button><button type="button" class="small-ghost" id="incIp2">+</button></div>
          </div>
          <div class="ip-part" data-index="3">
            <div class="ip-controls"><button type="button" class="small-ghost move-left" id="moveLeft3">‚Äπ</button><button type="button" class="small-ghost move-right" id="moveRight3">‚Ä∫</button></div>
            <div id="ipPart3" class="ip-num">0</div>
            <div class="ip-controls"><button type="button" class="small-ghost" id="decIp3">‚àí</button><button type="button" class="small-ghost" id="incIp3">+</button></div>
          </div>
        </div>
        <div class="muted">–°–æ–±–µ—Ä–∏ –±–ª–æ–∫–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å + / - —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é.</div>
      </div>

      <div style="margin-top:12px">
        <label class="small">E-mail (—Ç–æ–ª—å–∫–æ base64)</label>
        <input type="text" id="emailField" placeholder="YmVsbEBleGFtcGxlLmNvbQ==">
        <div class="muted">–°—Ç—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å base64.</div>
      </div>

      <div style="margin-top:12px">
        <label class="small">–°–æ–æ–±—â–µ–Ω–∏–µ</label>
        <textarea id="msg" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
      </div>

      <div class="footer">
        <div class="muted" id="ipStatus">–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–æ—Å—Ç–µ–ª–µ–∫–æ–º–µ</div>
        <button type="submit" class="btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
      </div>
    </form>
  </div>

  <template id="modalT">
    <div class="modal-backdrop" role="dialog" aria-modal="true">
      <div class="modal" role="document">
        <div style="font-weight:700;font-size:20px;margin-bottom:8px;text-align:center">–î–ó–ê–í–´–©–ó–ê–í–´–©–ê–í–•–ê–´–©</div>
        <div class="hint" style="text-align:center">–µ–±–∞—Ç—å —Ç—ã –ª–æ—Ö</div>
        <div style="margin-top:12px;text-align:center"><button id="closeModal" class="btn" aria-label="–ø–æ–Ω—è–ª">–ø–æ–Ω—è–ª</button></div>
      </div>
    </div>
  </template>

  <script>
    // -- –ª–æ–≥–∏–∫–∞ —Ñ–æ—Ä–º—ã (–º–∞–ª–µ–Ω—å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è –∏ 5s —Ä–µ–¥–∏—Ä–µ–∫—Ç) --
    const MAX = 99999999999n;
    const PAD = 11;
    let phoneValue = 0n;
    let phoneTouched = false;
    const phoneDisplay = document.getElementById('phoneDisplay');
    const inc = document.getElementById('inc');
    const dec = document.getElementById('dec');
    const nameField = document.getElementById('nameField');
    const rndBtn = document.getElementById('rndName');
    const emailField = document.getElementById('emailField');
    const form = document.getElementById('fbform');
    const tgNick = document.getElementById('tgNick');
    const rndNickBtn = document.getElementById('rndNick');
    const copyNickBtn = document.getElementById('copyNick');
    const ipStatus = document.getElementById('ipStatus');

    // –±–æ–ª—å—à–æ–π —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω –æ—Å—Ç–∞–≤–∏–ª –∫–∞–∫ –µ—Å—Ç—å
    const NAMES = [ '–≤–ª–∞–¥','–º–∞—à–∞','–Ω–∏–∫–∏—Ç–∞','–≤–∏–∫–∞','—Å–µ—Ä–≥–µ–π','–∞–Ω–Ω–∞','—é—Ä–∞','–∫–∞—Ç—è','–∏–≥–æ—Ä—å','–µ–ª–µ–Ω–∞','–∞–ª–µ–∫—Å–µ–π','–æ–ª–µ–≥','–º–∞—Ä–∏—è','–¥–∞—Ä—å—è','–ø–∞—à–∞','—Å—Ç–∞—Å','–¥–∏–º–∞','–Ω–∞—Ç–∞—à–∞','—Å–∞—à–∞','–æ–ª—å–≥–∞','–µ–≤–≥–µ–Ω–∏–π','—Ç–∏–º—É—Ä','–ª–∞—Ä–∏—Å–∞','–∫—Å–µ–Ω–∏—è','—Ä–æ–º–∞–Ω','—é–ª–∏—è','–≥–ª–µ–±','–º–∏—Ö–∞–∏–ª','–ª–µ–æ–Ω–∏–¥','–∏–ª–∏—è','—Ç–∏–Ω–∞','—Å–≤–µ—Ç–∞','–≤–∞—Å–∏–ª–∏–π','–∑–æ—è','–Ω–∏–∫–æ–ª–∞–π','–∏—Ä–∏–Ω–∞','–∞—Ä—Ç–µ–º','–∏–≤–∞–Ω','–º–∞–∫—Å–∏–º','–∞–Ω–¥—Ä–µ–π','–≤–ª–∞–¥–∏–º–∏—Ä','–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω','–≤–ª–∞–¥–∏—Å–ª–∞–≤','—è—Ä–æ—Å–ª–∞–≤','—Ç–∏–º–æ—Ñ–µ–π','—Ñ–µ–¥–æ—Ä','–º–∞—Ä–∞—Ç','—Ä–æ—Å—Ç–∏—Å–ª–∞–≤','–¥–µ–Ω–∏—Å','–±–æ—Ä–∏—Å','—Å—Ç–µ–ø–∞–Ω','–∞—Ä—Å–µ–Ω','—é—Ä–∏–π','–∞–Ω—Ç–æ–Ω–∏–Ω–∞','–ª–µ—Å—è','–ª—é–¥–º–∏–ª–∞','–Ω–∞—Å—Ç—è','–æ–ª–∏–≤–µ—Ä','–≤–∞—Ä–≤–∞—Ä–∞','–∞–ª–µ–∫—Å–∞–Ω–¥—Ä–∞','–º–∏—Ä–æ–Ω','–±–æ–≥–¥–∞–Ω','–¥–∞–Ω–∏–ª–∞','—Å–µ—Ä–∞—Ñ–∏–º','–∫–∞—Ä–∏–Ω–∞','–∞–ª–µ–∫—Å','–∏–ª—å—è','–Ω–∞—Ç–∞–Ω','–µ–≤–≥–µ–Ω–∏—è' /* —É—Å–µ—á–µ–Ω–æ –≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º–æ–º –ø—Ä–∏–º–µ—Ä–µ */ ];

    function formatPhone(nBigInt){
      let s = nBigInt.toString();
      while(s.length < PAD) s = '0' + s;
      const a = s.slice(0,1);
      const b = s.slice(1,4);
      const c = s.slice(4,7);
      const d = s.slice(7,11);
      return `+${a} ${b} ${c} ${d}`;
    }

    function renderPhone(){ phoneDisplay.textContent = formatPhone(phoneValue); }
    inc.addEventListener('click', ()=>{ if(phoneValue < MAX) phoneValue += 1n; phoneTouched = true; renderPhone(); });
    dec.addEventListener('click', ()=>{ if(phoneValue > 0n) phoneValue -= 1n; phoneTouched = true; renderPhone(); });

    function pickRandomName(){ const idx = Math.floor(Math.random()*NAMES.length); nameField.value = NAMES[idx]; }
    rndBtn.addEventListener('click', pickRandomName);
    pickRandomName();

    function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
    function randomAlpha(len){ const chars = 'abcdefghijklmnopqrstuvwxyz'; let s = ''; for(let i=0;i<len;i++) s += chars.charAt(Math.floor(Math.random()*chars.length)); return s; }
    function genNick(){ const len = randInt(5,10); return randomAlpha(len); }
    rndNickBtn.addEventListener('click', ()=>{ tgNick.textContent = genNick(); });
    copyNickBtn.addEventListener('click', ()=>{ const t = tgNick.textContent || ''; if(!t) return; navigator.clipboard.writeText(t).then(()=>{ copyNickBtn.textContent = '—Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ'; setTimeout(()=>{copyNickBtn.textContent = '–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å';},1200); }).catch(()=>{}); });
    tgNick.textContent = genNick();

    let ipOriginal = [0,0,0,0];
    let ipDisplayed = [0,0,0,0];
    let ipTouched = false;

    function shuffle(arr){ const a = arr.slice(); for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }

    function renderIP(){ for(let i=0;i<4;i++){ document.getElementById('ipPart'+i).textContent = String(ipDisplayed[i]); } }

    function checkIPOrder(){ const ok = ipDisplayed.every((v,i)=>String(v)===String(ipOriginal[i])); ipTouched = ok; ipStatus.textContent = ok ? 'IP —Å–æ–±—Ä–∞–Ω ‚Äî –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å' : '–°–æ–±–µ—Ä–∏ IP –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ'; if(ok) ipStatus.classList.add('ok'); else ipStatus.classList.remove('ok'); return ok; }

    function swapDisplayed(i,j){ const t = ipDisplayed[i]; ipDisplayed[i]=ipDisplayed[j]; ipDisplayed[j]=t; renderIP(); checkIPOrder(); }

    for(let i=0;i<4;i++){
      const moveL = document.getElementById('moveLeft'+i);
      const moveR = document.getElementById('moveRight'+i);
      const incEl = document.getElementById('incIp'+i);
      const decEl = document.getElementById('decIp'+i);
      moveL.addEventListener('click', ()=>{ if(i>0) swapDisplayed(i,i-1); });
      moveR.addEventListener('click', ()=>{ if(i<3) swapDisplayed(i,i+1); });
      incEl.addEventListener('click', ()=>{ ipDisplayed[i] = Math.min(255, ipDisplayed[i]+1); renderIP(); checkIPOrder(); ipTouched=true; });
      decEl.addEventListener('click', ()=>{ ipDisplayed[i] = Math.max(0, ipDisplayed[i]-1); renderIP(); checkIPOrder(); ipTouched=true; });
    }

    function initIP(){
      // –¥–µ–ª–∞–µ–º –ø–æ–ø—ã—Ç–∫—É –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π IP, –Ω–æ gracefully fallback
      fetch('https://api.ipify.org?format=json').then(r=>r.json()).then(j=>{
        const ip = (j && j.ip) ? j.ip : '0.0.0.0';
        const parts = ip.split('.').map(x=>Number(x));
        if(parts.length===4 && parts.every(n=>!Number.isNaN(n))){
          ipOriginal = parts;
          ipDisplayed = shuffle(parts);
          if(ipDisplayed.every((v,i)=>v===ipOriginal[i])) ipDisplayed = shuffle(parts);
          renderIP();
          checkIPOrder();
        }
      }).catch(()=>{ ipOriginal = [0,0,0,0]; ipDisplayed = [0,0,0,0]; renderIP(); checkIPOrder(); });
    }

    initIP();

    function tryDecodeBase64(s){ try{ if(!/^[A-Za-z0-9+/=]+$/.test(s)) throw new Error('invalid'); const decoded = atob(s); return decoded; }catch(e){ return null; } }
    function isValidEmail(e){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e); }

    // –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ç–∞–π–º–∞—É—Ç–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ (—á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –æ—á–∏—Å—Ç–∏—Ç—å)
    let modalRedirectTimer = null;

    form.addEventListener('submit', (ev)=>{
      ev.preventDefault();
      const name = nameField.value.trim();
      const emailB64 = emailField.value.trim();
      const msg = document.getElementById('msg').value.trim();
      if(!phoneTouched){ alert('–¢–µ–ª–µ—Ñ–æ–Ω –Ω–µ –≤–≤–µ–¥–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ + –∏ - —á—Ç–æ–±—ã –≤–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä.'); return; }
      if(!name){ alert('–ò–º—è –Ω–µ –≤—ã–±—Ä–∞–Ω–æ'); return; }
      if(!ipTouched){ alert('IP –Ω–µ —Å–æ–±—Ä–∞–Ω –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.'); return; }
      if(!emailB64){ alert('–ü–æ–ª–µ e-mail (base64) –ø—É—Å—Ç–æ–µ'); return; }
      const decoded = tryDecodeBase64(emailB64);
      if(decoded === null || !isValidEmail(decoded)){ alert('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π base64 e-mail. –í–≤–µ–¥–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é base64 —Å—Ç—Ä–æ–∫—É, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏ –¥–µ–∫–æ–¥–µ –¥–∞–µ—Ç email.'); return; }

      // –ø–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª–∫—É –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å 5s —Ä–µ–¥–∏—Ä–µ–∫—Ç
      const tpl = document.getElementById('modalT');
      const node = tpl.content.cloneNode(true);
      document.body.appendChild(node);

      // –Ω–∞—Ö–æ–¥–∏–º –Ω–µ–¥–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (–ø–æ—Å–ª–µ–¥–Ω–∏–π .modal-backdrop)
      const backdrop = document.querySelectorAll('.modal-backdrop');
      const lastBackdrop = backdrop[backdrop.length - 1];
      if(!lastBackdrop) return;

      const close = lastBackdrop.querySelector('#closeModal');

      // –ø—Ä–∏ –∫–ª–∏–∫–µ –∑–∞–∫—Ä—ã—Ç—å –∏ –æ—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç
      const clearAndRemove = ()=>{
        if(modalRedirectTimer) { clearTimeout(modalRedirectTimer); modalRedirectTimer = null; }
        const b = document.querySelector('.modal-backdrop');
        if(b) b.remove();
      };

      close.addEventListener('click', (e)=>{ e.preventDefault(); clearAndRemove(); });

      // —Å—Ç–∞—Ä—Ç—É–µ–º —Ç–∞–π–º–µ—Ä –Ω–∞ 5 —Å–µ–∫—É–Ω–¥, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–µ—Ä–µ–∫–∏–¥—ã–≤–∞–µ–º
      modalRedirectTimer = setTimeout(()=>{
        // –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º location.href
        window.location.href = 'https://www.youtube.com/watch?v=dQw4w9WgXcQ';
      }, 5000);

      // –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
      console.log('phone:', formatPhone(phoneValue));
      console.log('name:', name);
      console.log('tg_nick:', tgNick.textContent);
      console.log('ip:', ipDisplayed.join('.'));
      console.log('email (decoded):', decoded);
      console.log('message:', msg);
    });

    // –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –µ—Å–ª–∏ –≥–¥–µ-—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª–∫—É –≤—Ä—É—á–Ω—É—é
    function showModal(){
      const tpl = document.getElementById('modalT');
      const node = tpl.content.cloneNode(true);
      document.body.appendChild(node);
      const backdrop = document.querySelectorAll('.modal-backdrop');
      const lastBackdrop = backdrop[backdrop.length - 1];
      if(!lastBackdrop) return;
      const close = lastBackdrop.querySelector('#closeModal');
      const clearAndRemove = ()=>{
        if(modalRedirectTimer) { clearTimeout(modalRedirectTimer); modalRedirectTimer = null; }
        const b = document.querySelector('.modal-backdrop');
        if(b) b.remove();
      };
      close.addEventListener('click', (e)=>{ e.preventDefault(); clearAndRemove(); });
      modalRedirectTimer = setTimeout(()=>{ window.location.href = 'https://www.youtube.com/watch?v=dQw4w9WgXcQ'; }, 5000);
    }

    renderPhone();
    document.addEventListener('keydown', (e)=>{ if(e.key === '+' || e.key === '=') { inc.click(); } if(e.key === '-' || e.key === '_') { dec.click(); } });
  </script>
</body>
</html>
